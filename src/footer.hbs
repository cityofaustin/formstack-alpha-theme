<div>
  <script type="text/javascript">
    // Add handlebar Footer js partials to this function.
    function runFooterJs() {
      {{#unless isProduction}}
        /*
          Adds modified Formstack source code only for Preview builds.
          Use it for debugging
          It's been lightly modified from its original version for Handlebar compatibility.
        */
        {{> Formstack }}
      {{/unless}}
      {{> editPaginationButtons }}
      {{> moveHelperText }}
      {{> removeIframeMargins }}
      {{> translate }}
      {{> addCalendarIcon }}
      {{> renderBody }}
    }

    function addJQuery(cb){
      var currentElement = document.currentScript;
      var scriptNode = document.createElement('script');
      scriptNode.setAttribute('src', 'https://code.jquery.com/jquery-3.4.1.min.js');
      scriptNode.setAttribute('integrity', 'sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=');
      scriptNode.setAttribute('crossorigin', 'anonymous');
      scriptNode.setAttribute('async', 'false');
      scriptNode.onload = cb;
      currentElement.parentNode.insertBefore(scriptNode, currentElement.nextSibling);
    }

    /*
      The Footer js requires jQuery.
      The normal form body generated by Formstack loads jQuery.
      However the confirmation page body does not load jQuery.
      Therefore, we must manually load jQuery (for the sake of js working on the confirmation page), but only if jQuery is not already loaded.
      We accomplish this by appending a <script/> tag to the Footer which sources jQuery.
      The "onload" callback of the script tag will run our Footer js.
    */
    if (window.jQuery) {
      runFooterJs()
    } else {
      addJQuery(runFooterJs)
    }
  </script>
</div>
