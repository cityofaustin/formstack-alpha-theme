<div>
  <script type="text/javascript">
    // Add handlebar Footer js partials to this function.
    function runFooterJs() {
      jQuery.noConflict();
      // Must use jQuery explicitly instead of "$",
      // because "$" conflicts with Prototype library required by Formstack on "Save and Resume" and "Confirmation" pages.
      jQuery(function(jQuery){
        {{#unless isProduction}}
          /*
            Adds modified Formstack source code only for Preview builds.
            Use it for debugging
            It's been lightly modified from its original version for Handlebar compatibility.
          */
          {{> Formstack }}
        {{/unless}}
        {{> addDataIframeHeight }}
        {{> editPaginationButtons }}
        {{> moveHelperText }}
        {{> removeIframeMargins }}
        {{> addCalendarIcon }}
        {{> formatSaveAndResumePage }}
        // translate must be run only after new elements have been added
        {{> translate }}
        // renderBody only when you're done with all of your other js transformation
        {{> renderBody }}
      });
    }
    function addJQuery(cb){
      var currentElement = document.currentScript;
      var loadJQueryNode = document.createElement('script');
      loadJQueryNode.setAttribute('src', 'https://code.jquery.com/jquery-3.4.1.min.js');
      loadJQueryNode.setAttribute('integrity', 'sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=');
      loadJQueryNode.setAttribute('crossorigin', 'anonymous');
      loadJQueryNode.setAttribute('async', 'false');
      loadJQueryNode.onload = cb;
      currentElement.parentNode.insertBefore(loadJQueryNode, currentElement.nextSibling);
    }
    /*
      The Footer js requires jQuery.
      The normal form body generated by Formstack loads jQuery.
      However the confirmation page body does not load jQuery.
      Therefore, we must manually load jQuery (for the sake of js working on the confirmation page), but only if jQuery is not already loaded.
      We accomplish this by appending a <script/> tag to the Footer which sources jQuery.
      The "onload" callback of the script tag will run our Footer js.
    */
    if (window.jQuery) {
      runFooterJs()
    } else {
      addJQuery(runFooterJs)
    }
  </script>
</div>
